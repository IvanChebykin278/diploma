# Техническое задание

## Оглавление
1. [Термины и определения](#термины-и-определения)
    1. [Общие термины](#Общие-термины)
    1. [Технические термины](#Технические-термины)
1. [Общее положение](#Общее-положение)
    1. [Цель создания проекта](#Цель-создания-проекта)
    1. [Основные функциональные возможности Системы](#Основные-функциональные-возможности-Системы)
1. [Функциональные требования](#Функциональные-требования)
    1. [Диаграммы Вариантов Использования](#Диаграммы-Вариантов-Использования)
1. [Описание Вариантов Использования](#Описание-Вариантов-Использования)
    1. [ВИ "Создать объект доступа"](#ВИ-"Создать-объект-доступа")
    1. [ВИ "Создать уровень доступа"](#ВИ-"Создать-уровень-доступа")
    1. [ВИ "Изменить объект доступа"](#ВИ-"Изменить-объект-доступа")
    1. [ВИ "Администрирование модуля контроля доступа и распознавания лиц (идентификации)"](#ВИ-"Администрирование-модуля-контроля-доступа-и-распознавания-лиц-(идентификации)")
    1. [ВИ "Просмотреть статистику посещаемости сотрудников"](#ВИ-"Просмотреть-статистику-посещаемости-сотрудников")
    1. [ВИ "Просмотреть личную статистику посещаемости"](#ВИ-"Просмотреть-личную-статистику-посещаемости")
    1. [ВИ "Редактирования личной информации сотрудника/посетителя"](#ВИ-"Редактирования-личной-информации-сотрудника/посетителя")

## Термины и определения
### Общие термины
* Система - веб-приложение "СКУД с системой распознавания лиц", требования к которой указаны в данном документе
* Идентификатор - лицо сотрудника/посетителя
* Объект - контролируемая территория (офисное помещение)
* Объект доступа - человек, который хочет получить доступ на объект
### Технические термины
* Классификатор - аппроксимирующую функцию, решающая задачу классификации лица <!--Где-то должно быть про задачу классификации лица в виде "дано" - "найти"-->

## Общее положение
### Цель создания проекта
<!--выделить основную цель, основной список задач-->
1. С точки зрения организации
    * Обеспечение контроля доступа на объект (офис)
    * Удобный контроль посещаемости рабочего места сотрудниками <!--"удобный" - рекламное слово, не инженерное-->
    * Простота внедрения. Нет необходимости устанавливать специальное ПО на офисные компьютеры
2. С точки зрения клиента <!--вы ориентируетесь на клиента, если будете это ПО продавать, если нет, составить общий список задач-->
    * Удобный доступ на объект
    * Возможность просмотра статистики посещения рабочего места
### Основные функциональные возможности Системы <!-- Основные требования -->
<!--и в предыдущем разделе и здесь - раздел не начинается с перечисления (!), должна быть краткая подводка-->
<!-- Требования к структуре системы -->
<!-- и не описывать backend/frontend, обычно ТЗ читается людьми, далекими от разработки. В структуре описать все что есть по фронту -->
1. Backend
    * Распознавание лиц в видео потоке

    * Определение вероятности подделки идентификатора (лица)
    
    * Возможность изменения режимы пропускного контроля. Мягкий (в журнале событий будет отражен факт нарушения доступа, но система пропустит человека), временной (ориентир – время, руководствуясь которым система запрещает доступ в зону вплоть до выхода), строгий (система категорически запрещает повторный доступ до момента выхода) <!--режимы в подпункты, описание допускается давать дальше-->

    * Автоматическое добавление событий в базу данных исходя из анализа видео потока

    * Добавление неопознанных лиц в базу данных и присвоение ему уникального идентификатора (?)

    * Добавить/удалить отдел или подотдел

    * Добавить/изменить/удалить список сотрудников/посетителей, имеющих доступ на объект + описание фото и др. информация.

    * Добавить/изменить/удалить список идентификаторов сотрудника/посетителя

    * Возможность устанавливать различные варианты ограничений доступа на объект для сотрудника/посетителя

    * Добавление/изменение/удаление уровней доступа на объект + описание название и др. информация

    * Отчеты для владельца организации (?) <!--не понял знак вопроса-->

2. Frontend <!--если это одно приложение - обозначить как разные блоки, службы,... Если разные - разделить -->
    * Для оператора (охранника) (?) <!-- Оператора - ок -->
        * Отображение видопотока с камеры видонаблюдения + выделение области лица посетителя с кратной информацией о нем

        * Возможность просмотра лога событий в реальном времени

    * Для администратора системы
        * Найти необходимого сотрудника/посетителя

        * Найти необходимы отдел или подотдел

        * Администрирование сотрудников/посетителей: внесение изменений в список объектов доступа, изменение списка идентификаторов объекта доступа, присвоение ограничений для доступа на объект для объекта(ов) доступа

    * Для руководящих органов организации <!-- для руководителей-->
        * Возможность просмотра статистики посещений сотрудника(ов)/посетителя(ей)

        * Возможность получения аналитической информации о посещаемости сотрудника(ов)/посетителя(ей) (графики, средние показатели и т.д)

        * Все возможная сортировка и фильтрация данных статистики и аналитики

        * Отправка уведомлений сотруднику(ам) (?)

    * Для объектов доступа <!-- Выше вы написали что объект == офис, сам офис будет пользоваться этим ПО? -->
        * Возможность просмотра личной статистики посещаемости

        * Возможность просмотра собственной аналитической информации о посещаемости рабочего места (графики, средние показатели и т.д)

        * Все возможная сортировка и фильтрация данных статистики и аналитики

        * Возможность прочитать уведомления
## Функциональные требования
<!-- А здесь вы указываете то, что у вас в разделе backend выше и в терминальных элементах списка frontend, можно по отдельным разделам -->
### Диаграммы Вариантов использования
**Диаграмма 1. Действующие лица**

На данной диаграмме представлена иерархия всех Пользователей Системы и внешних
участников. Связь обобщения следует читать следующим образом: Пользователь наследует все
поведение своего родителя + имеет свое поведение в Системе.

![](./src/diagramma1.jpg "Диаграмма 1. Действующие лица")
<!-- Рисунок точно соответствует описанию? Вроде бы руководитель должен наследовать администратора, а все они наследуют незарегистрированного пользователя -->
> **TODO: доделать диаграммы вариантов использования**

## Описание Вариантов Использования
<!-- Что такое варианты использования? Не пересекается ли это с функциональными требованиями? -->
<!-- Если сценарии, то это должно быть описано в функциональных требованиях  -->
<!-- Во всем разделе явно не хватает макетов экранных форм или блок-схем или диаграмм потока данных, рассмотрите последний вариант -->
<!-- Раздел назвать по другому -->
### ВИ "Создать объект доступа"
**Описание ВИ**

* Должна быть возможность зарегистрировать сотрудника/посетителя в системе <!-- Не "должна быть", а "система/ПО должна обеспечивать" -->

**Предусловия**

* Сотрудник/посетитель не зарегистрирован в системе (не создана запись в списке объектов доступа с его персональными данными)

**Основной поток действий**

1. Администратор заходит в раздел "Объекты доступа"

2. Администратор нажимает на кнопку "Создать объект доступа". В зависимости от того существует ли отдел к которому приписан сотрудник:
    * Если существует отдел к которому приписан сотрудник, то необходимо нажать на существующий отдел в дереве объектов доступа
    * Если отдела не существует необходимо нажать на корневой элемента дерева объектов доступа
    * Для посетителей в дереве объектов доступа существует отдельный объект "Посетители"

3. Система отображает форму создания объекта доступа

4. Администратор вводит информацию о сотруднике/посетителе, вносит идентификаторы в список идентификаторов сотрудника/посетителя, так же он имеет возможность назначить уровень доступа, установить ограничения доступа на объект. Если администратор отменят действие форма создания объекта доступа закрывается.

5. Система проверят, что необходимые поля введены корректно. Если проверка прошла успешно, то поток продолжается, иначе сценарий переходит в п. 3, причем все значения (правильные и неправильные) должны отображаться в заполненных ранее полях с выделением неправильного поля и комментариями о существовании такого сотрудники/посетителя.

6. Система делает следующие действия:
    * Регистрирует сотрудника/посетителя с веденными ранее параметрами
    * Переобучает классификатор модуля распознавания лиц на основании списка идентификаторов сотрудника/посетителя
    * Блокирует интерфейс до получения ответа от сервера
    * Оповещает администратора о успешности создания записи сотрудника/пользователя и обучении классификатора

### ВИ "Создать уровень доступа"
**Описание ВИ**

* Должна быть возможность создать уровень доступа на объект

**Предусловия**

* Уровень доступа с необходимыми параметрами отсуцтвует в системе

**Основной поток действий**

1. Администратор заходит в раздел "Уровни доступа"

2. Администратор нажимает на кнопку "Создать уровень доступа"

3. Система открывает форму создания уровня доступа

4. Администратор вводит необходимые параметры. Если администратор отменят действие форма создания объекта доступа закрывается

5. Система проверят, что необходимые поля введены корректно. Если проверка прошла успешно, то поток продолжается, иначе сценарий переходит в п. 3, причем все значения (правильные и неправильные) должны отображаться в заполненных ранее полях с выделением неправильного поля и комментариями о существовании такого уровня доступа.

6. Система делает следующие действия: 
    * Регистрирует уровень доступа с веденными ранее параметрами
    * Блокирует интерфейс до получения ответа от сервера
    * Оповещает администратора о успешности создания записи уровня доступа

### ВИ "Изменить объект доступа"
**Описание ВИ**

* Администратор должен иметь возможность иметь данные о объекте доступа

**Предусловия**

* Объект доступа должен существовать в списке объектов доступа

**Основной поток действий**
1. Администратор заходит в раздел "Объекты доступа"

2. Администратор нажимает на объект доступа

3. Открывается форма объекта доступа

4. Администратор выбирает функцию редактирования объекта доступа

5. Отрывается форма редактирования объекта доступа с заполненными текущими данными. Поля которые могут быть изменены:
    * Личная информация:
        * Имя
        * Фамилия
        * Место проживания
        * Телефон
        * Элетронная почта
    * Список идентификаторов
    * Уровни доступа
    * Ограничения доступа

6. Администратор меняет данные и выбирает функция сохранить

7. Система делает следующие действия:
    * Проверяет параметры на соответствие форматов и сохраняет данные. При этом система сохраняет предыдущие значения для бэкапов. (?)
    * Если список идентификаторов был изменен, то система переобучает классификатор модуля распознавания лиц
    * Блокирует интерфейс до получения ответа от сервера (?)
    * Оповещает администратора о успешности операций

### ВИ "Администрирование модуля контроля доступа и распознавания лиц (идентификации)"
**Описание ВИ**

* Администратор должен иметь возможность настраивать параметры модуля идентификации

**Предусловия**

* Отсутствуют (скорее всего появятся в бушующем)

**Основной поток действий**
1. Администратор заходит в раздел "Модуль идентификации" (возможно название модуля поменяется)

2. Открывается форма с текущими параметрами модуля. В эти параметры входят:
    * Параметры модуля распознавания лиц
        * Минимальное расстояние от идентификатора до камеры видео наблюдения
        * Порог расстояния для классификации лица
        * Минимальная порог вероятности подлинности идентификатора (то есть, если рассчитанная вероятность идентификатора в видеопотоке будет меньше порогового значения, идентификатор будет расценен как поддельный)
        * (скорее всего добавятся еще некоторые параметры)
    * Режимы работы

3. Администратор вытирает функцию редактирования

4. Открывается форма редактирования с заполненными данными текущих значений параметров

5. Администратор редактирует необходимые параметры и выбирает функцию сохранить

7. Система делат следующие действия:
    * Проверяет параметры на соответствие форматов и сохраняет данные. При этом система сохраняет предыдущие значения для бэкапов. (?)
    * Блокирует интерфейс до получения ответа от сервера (?)
    * Оповещает администратора о успешности операций

### ВИ "Просмотреть статистику посещаемости сотрудников"
**Описание ВИ**

* Владелец организации или руководитель отдела должен иметь возможность просмотреть статистику посещаемости своих сотрудников

**Предусловия**

* Если статистку просматривает руководитель отдела, то он должен быть назначен в списке объектов доступа определенного отдела 

**Основной поток действий**
1. Владелец организации или руководитель отдела переходит в раздел "Статистка посещаемости"

2. Отрывается форма просмотра статистики

3. Владелец организации или руководитель выбирает необходимые способы фильтрации информации:
    * По дате и времени
    * По отделам или списку отделов
    * По конкретному сотруднику или списку сотрудников

4. Система делает следующие действия:
    * Возвращает информацию в зависимости от установленных фильтров

**Правила**
1. Руководитель отдела может просматривать статистику только своих подчиненных


### ВИ "Просмотреть личную статистику посещаемости"
**Описание ВИ**

* Сотрудник/посетитель должен иметь возможность просмотреть личную статистику посещения объекта

**Предусловия**

* Сотрудник/посетитель должен быть зарегистрирован в системе

**Основной поток действий**
1. Сотрудник/посетитель переходит в раздел "Статистика посещаемости"

2. Открывается форма просмотра статистики

3. Сотрудник/посетитель выбирает необходимые способы фильтрации информации:
    * По дате и времени

4. Система делает следующие действия:
    * Возвращает информацию в зависимости от установленных фильтров

### ВИ "Редактирования личной информации сотрудника/посетителя"
**Описание ВИ**

* Сотрудник/посетитель должен иметь возможность редактировать личную информацию

**Предусловия**

* Сотрудник/посетитель должен быть зарегистрирован в системе

**Основной поток действий**
1. Сотрудник/посетитель переходит в раздел "Личные данные"

2. Система отображает форму изменения личных данных с заполненными текущими данными. Поля которые могут быть изменены:
    * Имя
    * Фамилия
    * Адрес проживания
    * Телефон

3. Пользователь меняет данные и выбирает операцию «сохранить»

4. Система проверяет параметры на соответствие форматов и сохраняет данные. При
этом система сохраняет предыдущие значения для статистики

5. Система отправляет сообщение Адиминистратору о том, что изменились личные данные.
В теле сообщения должны быть переданы измененные данные.

6. Если Администратор видит некорректные данные, то он может изменить данные.
